\documentclass[review]{elsarticle}

\usepackage{xr} %% For cross-referencing supl figures
\externaldocument[S-]{Supplementary}

\usepackage{lineno,hyperref}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{amsfonts}
\usepackage{mathtools}

%% for the annex figure
\usepackage{tikz}
\usetikzlibrary{shapes,arrows,chains,calc}
% Set up a few colours for tikz figure
\colorlet{lcfree}{green}
\colorlet{lcnorm}{blue}
\colorlet{lccong}{red}

\usepackage{hhline}
\usepackage{booktabs}
\usepackage[textsize=scriptsize]{todonotes}
%\usepackage[textsize=scriptsize, disable]{todonotes}  %% to turn off notes
\usepackage{eurosym}
\usepackage{longtable}

\usepackage{enumitem}

% For track-changes
%\usepackage[draft]{changes}
\usepackage[final]{changes} %% to turn off changes
\definechangesauthor[color = red]{JM}
\definechangesauthor[color = blue]{PD}
\definechangesauthor[color = green!40!black]{JJ}
\definechangesauthor[color = purple]{CM}

\modulolinenumbers[1]

\journal{Ecological Modelling}

%% Harvard
\bibliographystyle{model2-names.bst}\biboptions{authoryear}
%%%%%%%%%%%%%%%%%%%%%%%
%% correct equation line numbering

\let\oldequation\equation
\let\oldendequation\endequation
\renewenvironment{equation}
 {\linenomathNonumbers\oldequation}
 {\oldendequation\endlinenomath}


%%%%%%%%%%%%%%%%%%%%%%



\begin{document}

\begin{frontmatter}
\title{\emph{MixFishSim}: highly resolved spatiotemporal simulations for
	exploring mixed fishery dynamics}

%% Group authors per affiliation:
\author[1,2]{Paul J. Dolder\corref{c}}
\cortext[c]{Corresponding author}
\ead{paul.dolder@gmit.ie}

\author[1]{Cóilín Minto}
\author[3]{Jean-Marc Guarini}
\author[4]{Jan Jaap Poos}

\address[1]{Galway-Mayo Institute of Technology (GMIT), Dublin Road, Galway,
	Ireland} 
\address[2]{Centre for Environment, Fisheries and Aquaculture Science (Cefas),
	Pakefield Road, Lowestoft, UK}
\address[3]{\replaced[id=JM]{Sorbonne Université, Faculty of
		Sciences}{Université Pierre et Marie Curie}, 4 Place Jussieu,
	75005 Paris, France}
\address[4]{Wageningen Marine Research, Haringkade 1 1976 CP IJmuiden,
	Netherlands}

\begin{abstract}

\replaced[id = JJ]{Most fisheries}{Fishing} exploit\deleted[id=JJ]{s} a variety 
of spatially and temporally heterogeneous fish populations using
species-unselective gear that can result in unintended, unwanted catch of low
quota or protected species. Reducing these unwanted catches is crucial for
biological and economic sustainability of `mixed fisheries' and implementation
of an ecosystem approach to fishing. \\

\replaced[id = PD]{If fisheries are to avoid unwanted catch}{To implement
	effective spatial measures to reduce discards} a good understanding of
spatiotemporal fishery dynamics is required. However, traditional scientific
advice is limited by a lack of highly resolved knowledge of population
distributions, population movement and how fishers interact with different fish
populations. This reflects the fact that data on fish location at high temporal
and spatial resolutions is expensive and difficult to collect. Proxies inferred
from either scientific surveys or commercial catch data are often used to model
distributions, usually with sparse data at limited spatial and temporal
resolution. \\ 

To understand how data resolution impacts inference on mixed fisheries
interactions, we develop a highly resolved spatiotemporal simulation model
incorporating: i) delay-difference population dynamics, ii) population movement
using Gaussian Random Fields to simulate patchy, heterogeneously distributed
populations, and iii) fishery dynamics for multiple fleet characteristics based
on species targeting under an explore-exploit strategy via a mix of correlated
random walk movement (for exploration) and learned behaviour (for exploitation)
phases of the fisheries.  \\ 

We simulate 50 years of fishing and use the results from the fisheries catch to
draw inference on the underlying population structures. We compare this
inference to a simulated fixed-site sampling design commonly used for fisheries
monitoring purposes and the true underlying population structures. We i) use
the results to establish the potential and limitations of fishery-dependent
data in providing a robust picture of spatiotemporal distributions; and ii)
simulate an area closure based on areas defined from the different data sources
at a range of temporal and spatial resolutions and assess their effectiveness
on reducing catches of a fish population. \\

We conclude from our simulations that commercial data, while containing bias,
provides a useful tool for managing catches in mixed fisheries if applied at
the correct spatiotemporal scale. \\

[333 words]

\end{abstract}

\begin{keyword}
Some\sep keywords \sep here. Max 6 
\MSC[2010] 00-01\sep  99-00
\end{keyword}

\end{frontmatter}

\linenumbers

\section{Introduction}

Fishers exploit a variety of fish populations that are heterogeneously
distributed in space and time, with varying knowledge of species distributions
and using species non-selective fishing gear. \added[id=PD]{In doing so}
fisheries \deleted[id=PD]{that}catch an assemblage of species
\added[id=PD]{and}\deleted{, known as mixed fisheries} \replaced[id=JJ]{may}{,
	when managed by single-species quotas can end up}
discard\deleted[id=JJ]{ing} over-quota catch \added[id=JJ]{when managed by
	single species quotas and fishers exhaust one or more quota. This may}
lead to overexploitation of fish populations \added[id=JJ]{\citep{Ulrich2011a,
		Batsleer2015}}.  \added[id=JJ]{Discarding of fish in
	excess of quota limits the ability to maintain fishing mortality within
	sustainable limits \citep{Alverson1994, Crowder1998, Rijnsdorp2007}}
\deleted[id=PD]{; reducing discarding is crucial}and the ability to manage for
the biological and economic sustainability of fisheries\deleted[id=JJ]{ and
	implementation of an ecosystem approach to fisheries}. As such, there
is increasing interest in technical solutions such as gear and spatial closures
as measures to \replaced[id=PD]{reduce unwanted catch}{avoiding
	discard\added[id=JJ]{ing of fish}} \citep{Kennelly2002, Catchpole2008,
	Bellido2011}\textcolor{red}{(ADD COSGROVE REFERENCE HERE)}.  \\

\replaced[id=PD]{Changes to spatial fishing patterns have}{Use of spatial
	management as a tools} been proposed as a method to reduce discards
\added[id=PD]{\citep{Holmes2011, Little2014, Dunn2014a}}.  \deleted[id=PD]{its}
Implementation of avoidance measures is, however, restricted by lack of
knowledge of fish and fishery spatiotemporal dynamics and understanding of the
scale at which processes become important for management. Understanding the
correct scale for spatial measures is crucial for implementation at a
resolution that ensures effective management \citep{Dunn2016} while minimising
economic impact.  For example, a scale that promotes species avoidance for
vulnerable or low quota species while allowing continuance of sustainable
fisheries for available quota species.\\

\replaced[id=PD]{Identifying}{Ensuring measures are implemented at} an
appropriate scale has been a challenge in the past that has led to ineffectual
measures with unintended consequences such as limited impact towards the
management objective or increased benthic impact on previously unexploited
areas (e.g. the cod closure in the North Sea
\citep{Rijnsdorp2001,Dinmore2003}). \replaced[id=PD]{M}{Since then m}ore
refined spatial information has \added[id=PD]{since} become available through
the combination of logbook and Vessel Monitoring System (VMS) data
\citep{Lee2010, Bastardie2010, Gerritsen2012, Mateo2016} and more real-time
spatial management has been possible \citep[e.g.][]{Holmes2011}.  Such
information is, however, derived from an inherently biased sampling programme,
targeted fishing, where fishers establish favoured fishing grounds through an
explore-exploit strategy \citep{Bailey2018} where they search for areas with
high catches and then use experience to return to areas where they've
experienced high catch in the past.  \deleted[id=PD]{ Further, fishers
	generally only recorded landings (not catch) on a daily
	basis\todo{\added[id=JJ]{Its not clear what the problem is: landings
			collected on daily basis or landings recorded rather
			than catch}}.  This leads to questions about the
	validity of inference that can be drawn from landings data assigned to
	VMS activity pings.}\todo{\added[id=JJ]{This comes as a surprise: I
		thought this was going to be about
		discards}\added[id=PD]{Agree, have removed this to avoid
		confusion}}\\ 

\replaced[id=PD]{We ask two fundamental questions regarding spatiotemporal
	inference derived from observational data:}{ and use the
	results}\deleted[id=PD]{ from the fishing model:}

\begin{enumerate}
	\item How does sampling-derived data reflects the underlying population
		structures? 	
	\item How does data aggregation and source impact on spatial fisheries
	management measures?
\end{enumerate}
	
To answer these questions we i) develop a simulation model where population
dynamics are highly-resolved in space and time\replaced[id=PD]{. Being}{ and
	are} known \added[id=PD]{directly} rather than inferred from sampling
or commercial catch\added[id=PD]{, we can use the population model to validate
	how inference from fisheries-dependent and fisheries independent
	sampling relates to the real population structure in a way we could not
	with real data}. We ii) compare, at different spatial and temporal
aggregations, the simulated population distributions to samples from
fisheries-dependent and fisheries independent catches to test if these are a
true reflection of the relative density of the populations. We then iii)
simulate a fishery closure to protect a species based on different spatial and
temporal data aggregations. We use these evaluations to draw inference on the
utility of commercial data in supporting management decisions.
\todo{\added[id=JJ]{If the paper has two goals this should be clear from the
		start, but may be better over 2 MSs}\added[id=PD]{I would like
		to keep both parts, but have made clearer in how its set out.
		The closure scenarios form validation of the data aggregation,
		rather than effectiveness of the closures themselves - so its a
		continuation of the same question in my eyes}}\deleted[id=PD]{.
	Further, we extend our analysis to a range of spatial and temporal
	scales to assess the impact of these processes on the success of the
	management measure.}\\

[We find..] 

\section{Materials and Methods}

\replaced[id=PD]{A}{We developed and implemented a simulation model with a}
\replaced{simulation model that is modular and discrete-event based was
	developed. This approach enables efficient computation by allowing
	for}{approach, where} \added[id=PD]{sub-}modules \deleted[id=PD]{are}
implemented on time-scales appropriate to capture the characteristic of the
\replaced[id=PD]{different processes}{process modelled} (Figure 1).
\added[id=PD]{The following sub-modules were included to capture the full
	system: 1) Population dynamics, 2) Recruitment dynamics, 3) Population
	movement, 4) fishery dynamics.}\\

\deleted[id=PD]{The fishing model operated on a tow-by-tow basis, while}
\replaced[id=PD]{P}{p}opulation dynamics (fishing and natural mortality,
growth) operate on a daily time-step\replaced[id=PD]{, while p}{. P}opulation
movement occurs on a weekly time-step\replaced[id=PD]{. R}{, while r}ecruitment
\replaced[id=PD]{takes place}{occurs} periodically each year for a set time
\replaced[id=PD]{duration}{period (e.g. 3 weeks)} specified for each
population\deleted[id=PD]{.}\added[id=PD]{, while the fishing module operates
	on a tow-by-tow basis (i.e. multiple events a day)}.  
\deleted[id=PD]{Here we describe each of the model components; 1) Population
	dynamics, 2) Recruitment dynamics, 3) Population movement dynamics, 4)
	fishery dynamics.}

\replaced[id=PD]{In the model system p}{P}opulation movement is driven by
random (diffusive) and directed (advective) processes and we incorporate
characterisation of a number of different fishing \added[id=PD]{fleet dynamics}
exploiting four fish populations with different spatial and population
demographics. The following describes the implementation of each of the
sub-modules.

%% the tikz figure
\clearpage
\input{Process_model.tex}

\subsection{Population dynamics}

The basic population level processes are simulated using a modified two-stage
Deriso-Schnute delay difference model \citep{Deriso1980, Schnute1985,
	Dichmont2003} occurring at a daily time-step. \added[id=PD]{A daily
	time-step was chosen to discretise continuous population processes on a
	biologically relevant and computationally tractable timescale.}
\replaced[id=PD]{Under the population dynamics module}{Here,} population
biomass growth and depletion for pre-recruits and\deleted[id=PD]{fish}
recruited \added[id=PD]{fish}\deleted[id=PD]{to the fishery} are modelled
separately as a function of previous recruited biomass, intrinsic population
growth and recruitment functionally linked to the adult population size.
Biomass for each cell $c$ is incremented each day $d$ as follows (the full
parameter list is detailed in Table \ref{tab: pop_variable}): \begin{equation}
	\begin{split}
	B_{c,d+1} = &\\
	& (1 + \rho) B_{c,d} \cdot e^{-Z_{c,d}} - \rho \cdot e^{-Z_{c,d}} \hspace{2.9cm}
	\times \\  
	& (B_{c,d-1} \cdot e^{-Z_{c,d-1}} + Wt_{R-1} \cdot \alpha_{d-1} \cdot
	R_{\tilde{y}(c,y,d-1)})
	\hspace{0.4cm} + \\
	& Wt_{R} \cdot \alpha_{d} \cdot R_{\tilde{y}(c,y,d)} 
	\end{split}
\end{equation}
where $\rho$ is Brody's coefficient, shown to be equal to $e^{-K}$ when $K$ is
the growth rate from a von Bertalanffy logistic growth model
\citep{Schnute1985}. $Wt_{R-1}$ is the average weight of fish prior to
recruitment, while $Wt_{R}$ is the average recruited weight. $\alpha_{d}$
represents the proportion of fish recruited during that day for the year, while
$R_{c,\tilde{y}}$ is the annual recruits in cell $c$ for year $y$. \\

Mortality $Z_{c,d}$ can be decomposed to natural mortality, $M_{c,d}$, and
fishing mortality, $F_{c,d}$, where both $M_{c,d}$ and $F_{c,d}$ are
instantaneous rates with $M_{c,d}$ fixed and $F_{c,d}$ calculated by solving
the Baranov catch equation \citep{Hilborn1992b} for $F_{c,d}$:
\begin{equation}
C_{c,d} = \frac{F_{c,d}}{F_{c,d} + M_{c,d}} * (1 - e^{-(F_{c,d} + M_{c,d})}) *
B_{c,d}
\end{equation}
where $C_{c,d}$ is the summed catch from the fishing model across all fleets
and vessels in cell $c$ for the population during the day $d$, and $B_{c,d}$
the daily biomass for the population in the cell. Here, catch and fishing
mortality are the sum of those across all fleets and vessels, where $F_{fl, v,
	c, d, p} = E_{fl, v, c, d} \cdot Q_{fl, p} \cdot B_{c, d, p}$ with
$fl$, $v$ and $p$ the fleet, vessel and population respectively and $E$ and $Q$
fishing effort and catchability. \todo{\added[id=CM]{[link $F$ to effort and
		catchability - as I think we have F as an emergent property of
		the fleets rather than something we solve for (I could be wrong
		though!) - catch for a vessel is a product of catchability and
		biomass, i.e. C = qB, but this catch is summed to solve for F.
		So its both really]}}\\

\subsection{Recruitment dynamics}

Recruitment is modelled through a function relating the adult biomass to
recruits at time of recruitment. In \emph{MixFishSim}, it can be modelled
either either as a stochastic Beverton-Holt stock-recruit form
\citep{Beverton1957}: 
\begin{equation}
	\begin{split}
	\bar{R}_{c,d} = & \frac{(\alpha * S_{c,d})}{(\beta + S_{c,d})} \\
	     R_{c,d} \sim & \log N[(\log(\bar{R}_{c,d}),\sigma^2)]
	\end{split}
\end{equation}
Where $\alpha$ is the maximum recruitment rate, $\beta$ the spawning stock
biomass (SSB) required to produce half the maximum stock size, $S$ current
stock size and $\sigma^2$ the variability in the recruitment due to stochastic
processes, or a stochastic Ricker form \citep{Ricker1954}:
\begin{equation}
	\begin{split}
	\bar{R}_{c,d} = & B_{c,d} * e^{(\alpha - \beta * B_{c,d})} \\	
   	     R_{c,d} \sim & \log N[(\log(\bar{R}_{c,d}),\log(\sigma^2))]
	\end{split}
\end{equation}
where $\alpha$ is the maximum productivity per spawner and $\beta$ the density
dependent reduction in productivity as the SSB increases. In our example
application the Beverton-Holt form of stock recruit relationship was used for
all populations though either functional form can be chosen.

\subsection{Population movement dynamics}

To simulate \deleted[id=JJ]{how} fish population\deleted[id=JJ]{s might be}
distribut\replaced[id=JJ]{ion}{ed} in space and time\deleted[id=JJ]{, we
	employed} a Gaussian spatial process \added[id=JJ]{was employed} to
model habitat suitability for each of the populations on a 2d grid. \\

\deleted[id=PD]{the habitat}We first define\added[id=PD]{d} a Gaussian random
field process\todo{\added[id=JJ]{Not clear how habitat/GRF affect local
		abundances, only have $B_{y,d}$}\added[id=PD]{Have included
		cell reference, $c$ to make spatial link explicit}}, $\{S(c) :
c \in \mathbb{R}^2\}$, \deleted[id=PD]{that is a stochastic process} where
\added[id=PD]{for} any set of cells $c_{1}, \dots, c_{n}$ \deleted[id=PD]{where
	for each $c_{i} \in \mathbb{R}^2$}, the joint distribution of $S =
\{S(c1),\dots S(c_{n})\}$ is multivariate Gaussian with a \textit{Matérn}
\deleted[id=PD]{family of}covariance structure\deleted[id=PD]{s},
\replaced[id=PD]{where}{one where} the correlation strength weakens with
distance\deleted[id=PD]{(i.e. the correlation between $S(x)$ and $S(x')$
	decreases as the distance $u = ||x - x'||$ increases)}.
\added[id=PD]{This enables us to model the spatial autocorrelation observed in
	animal populations where density is more similar in nearby locations
	\citep{Tobler1970, F.Dormann2007}} and we change the parameters to
implement different spatial structures for the populations. \\

\replaced[id=PD]{T}{In the simulation model, t}he habitat for each of the
populations \replaced[id=PD]{was}{is} generated \replaced[id=PD]{with}{through}
the \textit{RFSimulate} function of the \textit{RandomFields} R package
\citep{Schlater2015}, which simulates a Gaussian Random Field process given a
user defined error model and correlation structure. We define a stationary
habitat field and combine with a temporally dynamic thermal tolerance field to
imitate two key drivers of population dynamics. Each population
\replaced[id=PD]{was}{is} initialised at a single location, and subsequently
move\replaced[id=PD]{ed}{s} according to a probabilistic
distrib\added[id=PD]{u}tion based on habitat suitability (represented by the
normalised values from the GRFs), temperature and distance
from current cell\replaced[id=PD]{:}{.} 
\begin{equation}
	Pr(J | I) = \frac{e^{-\lambda * d_{IJ}} \cdot
		(Hab_{J,p}^2 \cdot Tol_{J,p,wk})}{\sum\limits_{c=1}^{C}e^{-\lambda * d} \cdot
		(Hab_{c,p}^2 \cdot Tol_{c,p,wk})}
\end{equation}
Where $d_{IJ}$ is the euclidean distance between cell $I$ and cell $J$,
$\lambda$ is a given rate of decay, $Hab_{J,p}^2$ is the squared index of
habitat suitability for cell $J$ and population $p$, with $Tol_{J,p,wk}$ the
temperature tolerance for cell $J$ by population $p$ in week $wk$ (see
below).\\

During pre-defined weeks of the year the habitat quality is modified with
\added[id=PD]{user-defined} spawning habitat locations\deleted[id=PD]{s},
\replaced[id=PD]{resulting in}{meaning} each population
\replaced[id=PD]{having}{has} concentrated areas where spawning takes place. In
the simulations the populations move\deleted[id=PD]{s} towards
\replaced[id=PD]{these cells}{this} in the weeks prior to spawning, resulting
in directional movement towards the spawning grounds.\todo{\added[id=JM]{What
		does it mean concisely? Areas are assigned?} \added[id=PD]{Yes,
		the areas are pre-defined - I have amended to reflect and tried
		to clarify}} \\

\replaced[id=JJ]{An}{, with an} advection-diffusion process\deleted[id=JJ]{to}
control\added[id=JJ]{s}\deleted[id=JJ]{how the} population\deleted[id=JJ]{s}
move\replaced[id=JJ]{ment}{d}, with a time-varying temperature covariate used
to change the interaction between time and suitable habitat on a weekly
time-step\todo{\added[id=JJ]{What have a temperature covariate? Could just use
		time}\added[id=PD]{Was intended as some biological meaning -
		species thermal tolerances load onto the temperature effect -
		so could be different per species}}.  \deleted[id=JJ]{This was
	intended to balance realism in population movement, capturing the main
	directed and random processes, and practicality of modelling the
	population rather than individual fish.} Each population $p$
\replaced[id=PD]{wa}{i}s assigned a thermal tolerance with mean,
$\mu\added[id=PD]{_{p}}$ and variance, $\sigma^2\added[id=PD]{_{p}}$ so that
each cell and population temperature suitability is defined that:
\begin{equation}
	Tol_{c, p\added[id=PD]{, wk}} = \frac{1}{ \sqrt (2\pi \cdot \sigma^2_{p})} \cdot \exp(-
		\frac{(T_{c\added[id=PD]{, wk}} - \mu_{p})^2}{2 \cdot \sigma^2_{p}} )	
\end{equation}
Where $Tol_{c, p, \added[id=PD]{wk}}$ is the tolerance of population $p$ for
cell $c$ \added[id=PD]{in week $wk$}, $T_{c, \added[id=PD]{wk}}$ is the
temperature in the cell \added[id=PD]{given the week} and
$\mu\added[id=PD]{_{p}}$ and $\sigma^2\added[id=PD]{_{p}}$ the mean and
standard deviation of the population temperature tolerance. \\

\added[id=PD]{The final process results in a population structure and movement
	pattern unique to each species, with population movement occurring on a
	weekly basis. The decision to model population movement on a weekly
	timescale was to reflect that fish tend to aggregate in species
	specific locations and range within a week is fairly limited
	[\textcolor{red}{REF!!}].  Therefore this process approximated the
	demographic shifts in fish populations throughout a year with seasonal
	spawning patterns (e.g.  Figure \ref{S-fig:5}).}

\subsection{Fleet dynamics}

The fleet dynamics can be broadly categorised into three components; fleet
targeting - which determine\replaced[id=PD]{d}{s} the fleet catch efficiency
and preference towards a particular species; trip-level decisions, which
determine\added[id=PD]{d} the initial location to be fished at the beginning of
a trip; and within-trip decisions, determining movement from one fishing spot
to another within a trip. Together, these elements implement an explore-exploit
type strategy for individual vessels to maximise their catch from an unknown
resource distribution (\cite{Bailey2018}). The decision to use an individual
based model for fishing vessels was taken because fishers as a group tend to
show heterogeneity and individual rather than group dynamics
[\textcolor{red}{REF!}]. Therefore in the simulations fleet dynamics are the
productive of individual experiences rather than pre-defined group dynamics. 

\subsubsection{Fleet targeting}

Each fleet of \textit{n} vessels \replaced[id=PD]{was}{is} characterised by
both a general efficiency, $Q_{fl}$, and a population specific efficiency,
${Q_{fl, p}}$.  Thus, the product of these parameters [$Q_{fl} \cdot Q_{fl,
	p}$] affect\replaced[id=PD]{s}{ed} the overall catch rates for the
fleet and the preferential targeting of one population over another. This, in
combination with the parameter choice for the step-function
\added[id=PD]{defined below} (as well as some randomness from the exploratory
fishing process) determine\replaced[id=PD]{d}{s} the preference of fishing
locations for the fleet.  All species prices \replaced[id=PD]{were}{are} kept
the same across fleets \replaced[id=PD]{and seasons}{, though can be made to
	vary seasonally}.  

\subsubsection{Trip-level decisions}

Several studies \citep[e.g.][]{Hutton2004, Tidd2012, Girardin2015} have
confirmed past activity and past catch rates are strong predictors of fishing
location choice. For this reason, the fleet dynamics sub-model
include\replaced[id=PD]{d}{s} a learning component, where a vessel's initial
fishing location in a trip \replaced[id=PD]{wa}{i}s based on selecting from
previously successful fishing locations. This \replaced[id=PD]{wa}{i}s achieved
by \added[id=PD]{calculating an expected revenue based on the catches from
	locations fished} in the preceding trip as well as the same month
periods in previous years and the travel costs from the port to the fishing
grounds, and choosing randomly from the top 75 \% of fishing events
\replaced[id=PD]{as defined by the expected profit, which has a seasonal
	component}{in value}. 

\subsubsection{Within-trip decisions}

Fishing locations within a trip are \added[id=PD]{initially} determined by a
modified random walk process. \added[id=PD]{As the simulation progresses the
	within-trip decision become gradually more influenced by experience
	gained from past fishing locations (as per the initial trip-level
	location choice), moving location choice towards areas of higher
	perceived profit.} A random walk was chosen for the exploratory fishing
process as it is the simplest assumption commonly used in ecology to describe
\added[id=PD]{optimal} animal\deleted[id=PD]{movement which}
search\replaced[id=PD]{ strategy}{ing} for \added[id=PD]{exploiting}
homogeneously distributed prey about which there is uncertain knowledge
\citep{Viswanathan1999}. In a random walk, movement is a stochastic process
through a series of steps\added[id=JJ]{. These steps have a length, and a
	direction} that can either be equal in length or take some other
functional form. The direction of the random walk was also correlated (known as
`persistence') providing some overall \deleted[id=PD]{location of}directional
movement \citep{Codling2008}\deleted[id=PD]{or uncorrelated}. \\

We use a \textit{\replaced[id=JJ]{Lévy flight} {lévy walk}} which is a
particular form of random walk characterised by a heavy-tailed distribution of
step-length\replaced[id=JJ]{. The Lévy flight}{and} has received a lot of
attention in ecological theory in recent years as having shown to have very
similar characteristics as those observed by animals in nature, and being a
near optimum searching strategy for predators pursuing patchily distributed
prey \citep{Viswanathan1999, Bartumeus2005, Sims2008}.  \citet{Bertrand2007}
showed that Peruvian anchovy fishermen have a stochastic search pattern similar
to that observed with a lévy flight. However, it remains a subject of debate
\added[id=PD]{\citep[e.g. see][]{Edwards2011, Reynolds2015}}, with the
contention that search patterns may be more simply characterised as random
walks \citep{Sakiyama2013} with specific patterns related to the
characteristics of the prey field \citep{Sims2012}. \\

For our implementation of a random walk directional change is based on a
negatively correlated circular distribution where a favourable fishing ground
is likely to be ``fished back over" by the vessel returning in the direction it
came from.  The step length (i.e. the distance travelled from the current to
the next fishing location) is determined by \deleted[id=JJ]{relating} recent
fishing success, measured as the summed value of fish caught (revenue, $Rev$),
\begin{equation}
Rev = \sum_{p=1}^{P} \replaced[id=PD]{L}{C}_{p} \cdot Pr_{p} 
\end{equation}
where $\replaced[id=PD]{L}{C}_{p}$ is \replaced[id=PD]{landings}{catch} of a
population $p$, and $Pr_{p}$ price of a population. Here, when fishing is
successful vessels remain in a similar location and continue to exploit the
local fishing grounds. When unsuccessful, they move some distance away from
the current fishing location.  The movement distance retains some degree of
stochasticity, which can be controlled separately, but is determined by the
relationship: 
\begin{equation}
	StepL = e^{log(\beta_{1}) + log(\beta_{2}) -
		(log(\frac{\beta_{1}}{\beta_{3}}))} * Rev
\end{equation}\todo{\added[id=JJ]{So
			step length increases with increasingly gross
			revenue?}\added[id=PD]{No, the opposite}}
Where $\beta_{1}$, $\beta_{2}$ and $\beta_{3}$ are parameters determining the
shape of the step function in its relation to revenue, so that, a step from
(x1,y1) to (x2, y2) is defined by:
\begin{equation}
	\begin{split}
 (x2, y2) =  & x1 + StepL \cdot \cos (\frac{\pi \cdot Br}{180}), \\
             & y1 + StepL \cdot \sin (\frac{\pi \cdot Br}{180}) \\	
 with  \hspace{0.5cm}     & Br_{t-1} < 180, Br_{t} = 180 + \sim vm[(0,360), k] \\
 			  & Br_{t-1} > 180, Br_{t} = 180 - \sim vm[(0,360), k] \\
	\end{split}
\end{equation}
where $k$ the concentration parameter from the von \replaced[id=JJ]{M}{m}ises
distribution which we correlate with the revenue so that $k = (Rev + 1 /
RefRev) * max_{k}$, where $max_{k}$ is the maximum concentration value, $k$,
and $RefRev$ is parametrised as for $\beta_{3}$ in the step length function. A
realised example of the step length and turning angle relationships to revenue
can be seen at Figure \ref{S-fig:15}.

\subsubsection{Local population depletion}

Where several fishing vessels exploit the same fish population competition is
known to play an important role in local distribution of fishing effort
\citep{Gillis1998}. If several vessels are fishing on the same patch of fish,
local depletion and interference \added[id=JJ]{competition} will affect fishing
location choice of the fleet as a whole \citep{Rijnsdorp2000, Poos2007a}. In
order to account for this behaviour, the fishing sub-model operates spatially
on a daily time-step so that for future days the biomass available to the
fishery is reduced in the areas fished. The cumulative effect is to make
heavily fished areas less attractive as a future fishing location choice as
reduced catch rates will be experienced. 

\subsection{Fisheries independent survey}

A fisheries-independent survey is simulated where fishing on a regular grid
begins each year at the same time for a given number of stations (a fixed
station survey design). Catches of the populations \replaced[id=JJ]{at each
station}{present} are recorded but not removed from the population. This
provides a fishery independent snapshot of the populations at a regular spatial
\replaced[id=JJ]{intervals}{distribution} each year, similar to scientific
surveys undertaken by fisheries research agencies. \\

\subsection{Software}

The simulation framework is implemented in the statistical software package R
\citep{RCoreTeam2017} \replaced[id=PD]{and}{;} available as an R package from
the authors github site (\url{www.github.com/pdolder/MixFishSim}).\\

\section{Parameterisation}

\subsection{Population models}

We parametrised the simulation model for four populations with different
demographics; growth rates, natural mortality and recruitment functions (Table
\ref{tab:1}). Habitat preference (Figure \ref{S-fig:1}) and temperature
tolerances (Figures \ref{S-fig:3}, \ref{S-fig:4}) were unique to each
population resulting in differently weekly distribution patterns (Figures
\ref{S-fig:5}-\ref{S-fig:7}). In addition, each of the populations has two
defined spawning areas which result in the populations moving towards these
areas in pre-defined weeks (Figure \ref{S-fig:2}) with population-specific
movement rates (Table \ref{tab:1}). The individual habitat preferences and
thermal tolerances result in different spatial habitat use for each population
(Figure \ref{S-fig:9}) and consequently different seasonal exploitation
patterns (Fishing mortality in Figure \ref{S-fig:10}). 

\subsection{Fleet parametrisation}

The fleets were parametrised to reflect five different characteristic fisheries
with unique exploitation dynamics (Table \ref{tab:2}).  \replaced[id=PD]{By
	setting different catchability parameters ($Q_{fl, p}$) we create
	different targeting preferences between the fleets and hence spatial
	dynamics}{This ensures that different fleets have different spatial
	dynamics, preferentially targeted different fish populations}.  The
stochasticity in the random walk process ensures that within a fleet different
vessels have slightly different spatial distributions based on individual
experience. The step function was parametrised dynamically within the
simulations as the maximum revenue obtainable was not known beforehand. This
was implemented so that vessels take smaller steps when fishing at a location
that yields landings value in the top 90th percentile of the value experienced
in that year so far (as defined per fleet in Table \ref{tab:2}). \\

With increasing probability throughout the simulation, fishing locations were
chosen based on experience of profitable catches built up in the same month
from previous years and from the previous trip. 'Profitable' in this context
was defined as the locations where the top 70 \% of expected profit would be
found given previous trips revenue and cost of movement to the new fishing
location.  This probability was based on a logistic sigmoid function with a
lower asymptote of 0 and upper asymptote of 0.95, and a growth rate which
ensures the upper asymptote (where decisions are mainly based on past
knowledge) is reached approximately halfway through the simulation.  \\


\subsection{Survey settings}

The survey simulation was set up with a fixed gridded station design with 100
stations fished each year, starting on day 92 \added[id=PD]{and ending on day
	112 (5 stations per day)} with same catchability parameters for all
populations ($Q_{p} = 1$). This approximates a real world survey design with
limited seasonal and spatial coverage. 

\subsection{Example research question}

To illustrate the capabilities of \emph{MixFishSim}, we investigate the
influence of the temporal and spatial resolution of different data sources on
the reduction in catches of a population given spatial closures. To do so, we
set up a simulation to run for 50 years based on a 100 $\times$ 100 square grid
(undetermined units), with five fleets of 20 vessels each and four fish
populations. Fishing takes place four times a day per vessel and five days a
week, while population movement is every week.

We allow the simulation to run unrestricted for 30 years\todo{\added[id=JJ]{Is
		there equilibrium after 5 years or still some trend in B?
	}\added[id=PD]{I have rerun to ensure some steady state dynamics}},
then implement spatial closed areas for the last 20 years of the simulation
based on data (either derived from the commercial catches,
fisheries-independent survey or the 'real population') used at different
spatial and temporal scales. \\

The following steps are undertaken to determine closures:
\todo{\added[id=JJ]{Procedure unclear. Refer to symbols in methods section or
		switch order starting with description of data type
		etc..}\added[id=PD]{Yes, will redo}}
\begin{enumerate}
	\item Extract data source
	\item Aggregate according to desired spatial and temporal resolution
	\item Interpolate across entire area at desired resolution using simple
		kriging using the \emph{interp} function from the R package
		akima [\textcolor{red}{REF!}].
	\item Close area covering top 5 \% of catch rates 
\end{enumerate}
In total 28 closure scenarios were run which represent combinations of:

\begin{itemize}
	\item \textbf{data types:} commercial logbook data, survey data and
		`real population',
	\item \textbf{temporal resolutions:} weekly, monthly and yearly
		closures,
	\item \textbf{spatial resolutions:} 1 x 1 grid, 5 x 5 grid, 10 x 10
		grid and 20 x 20 grid,
	\item \textbf{closure basis:} highest 5 \%  of catch rates for the
		protected species
\end{itemize}

Survey closures were on an annual basis only, as this was the most temporally
resolved survey data available.

\section{Results}

\subsection{Simulation dynamics}

It can be seen from a single vessels movements during a trip that the vessel
exploits four different fishing grounds, three of them multiple times (Figure
\ref{S-fig:11}), while across several trips fishing grounds that are further
apart are fished (Figure \ref{S-fig:12}). These different locations relate to
areas where the highest revenue were experienced, as shown by
\added[id=PD]{Figure} \ref{S-fig:13}, where several trips for the vessel
overlaid on the revenue field, i.e. 
$$\sum^c_{c=1}\sum^s_{s=1} B_{s,c} \cdot Q_{s,c}$$

Vessels from the same fleet (and therefore targeting preference) exploit
similar but slightly different fishing grounds depending on their own personal
experience during the explore phase of the fishery (\added[id=PD]{Figure}
\ref{S-fig:14}), which is the result of the randomness in the correlated random
walk step function, with distance moved during the exploitation phase and the
direction stochastically related to the revenue experienced on the fishing
ground (\replaced[id=PD]{Figure}{while}
\ref{S-fig:15}).\todo{\added[id=JJ]{Move some of the supplementary figures to
		the manuscript}} 

\subsection{How does sampling-derived data reflect the underlying population
	structure?}

In order to answer this question we compare different spatial and temporal
aggregations of the simulated population distributions to:
\begin{enumerate}[label=\alph*)]
	\item \textbf{fisheries-independent data:} the inferred population from
		a fixed-site sampling survey design as commonly used for
		fisheries monitoring purposes;
	\item \textbf{fisheries-dependent data:} the inferred population from
		our fleet model which includes fishery-induced sampling
		dynamics.
\end{enumerate}

Figure \ref{fig:1} shows the aggregated catch composition from each of the data
sources over a ten-year period (to average seasonal patterns) at different
spatial resolutions. The finer spatial grid for the real population (top left)
and commercial data (top middle) show visually similar patterns, though there
are large unsampled areas in the commercial data from a lack of fishing
activity (particularly in the lower left part of the sampling domain). The
survey data at this spatial resolution displays very sparse information about
the spatial distributions of the populations. The slightly aggregated data on a
5 x 5 grid shows similar patterns and, while losing some of the spatial detail,
there remains good consistency between the `real population' and the commercial
data. Survey data starts to pick out some of the similar patterns as the other
data sources, but lacks coverage. The spatial catch information on a 10 x 10
and 20 x 20 grid lose a significant amount of information about the spatial
resolutions for all data sources, and some differences between the survey,
commercial and 'real population' data emerge. \\

Figure \ref{fig:2} shows the consequences of different temporal aggregations of
the data over a ten-year period, with weekly (top), monthly (middle) and yearly
(bottom) catch compositions from across an aggregated 20 x 20 area. As can be
seen by comparison to the 'real population', the monthly aggregation captures
the major patterns seen in the weekly data, albeit missing more subtle
differences. The yearly data results in a constant catch pattern due to the
aggregation process (sometimes known as an aggregation bias). The commercial
data on a weekly basis shows some of the same patterns as the 'real
population', though the first species (in red) is less well represented and
some weeks are missing catches from the area. The monthly data shows some
consistency between the 'real population' and commercial data for species 2 -
4, though species 1 remains under-represented. On an annual basis,
interestingly the commercial data under represents the first species (in red)
while the survey over represents species 1. This is likely due to the biases in
commercial sampling, with the fisheries not targeting the areas where species 1
are present, and the biases in the survey sampling from over representation of
the spatial distribution. 

\subsection{How does data aggregation and source impact on spatial fisheries
	management measures?}

We implemented a spatial closure using the different data sources and spatial
and temporal aggregations as outlined in the protocol in Section 3.4. We used
this to assess the efficacy of a closure in reducing fishing mortality on
species 3, given availability of data and its use at different resolutions in
order to evaluate the trade-offs in data sources. 

The trend in fishing mortality for each species show that in most cases the
fishery closure was successful in reducing fishing mortality on the species of
interest (species 3; Figure \ref{fig:3}), though interestingly the largest
reductions in fishing mortality happened immediately after the closures,
following which the fisheries "adapted" to the closures and fishing mortality
increased again somewhat. The exception to the success was the closures
implemented based on the coarsest spatial (20 x 20) and temporal resolution
(yearly) which were ineffective with all data sources. As expected, closures
based on the "known" population distribution were most effective, with
differing degrees of success using the commercial data. Fishing mortality rates
on the other species changed in different proportions, depending on whether the
displaced fishing effort moved to areas where the populations were found in
greater or lesser density. \\

A regression tree (using the R package REEMtree [ref]) highlights that the
factor most contributing to differences in fishing mortality before and after
the closure was the population (72 \% showing that the closures were effective
for population 3), followed by data resolution (21 \%), data type (7 \%) with
the least important factor the timescale ($<$ 1 \%). In general the finer the
spatial resolution of the data used the greater reduction in fishing mortality
for population 3 after the closures (Figure \ref{fig:4}). The notable outliers
are the commercial data at the coarsest spatial resolution (20 x 20) at a
yearly and weekly timescale, where closures were nearly as effective as the
fine-scale resolution. In this case the closures were sufficiently large to
protect the population (and was as effective as when the closure was based on
the "real population"; \textcolor{red}{CHECK THIS, COULD PLOT ACTUAL CLOSURE
	LOCATIONS??}) but this may have consequences in terms of restricting a
much larger area than necessary. \\

\section{Discussion}

INCLUDE SUBHEADINGS TO MATCH RESULTS

%% General intro

Our study evaluates the importance of data scaling and considers potential bias
introduced through data aggregation when using fisheries data to infer
spatio-temporal dynamics of fish populations. Understanding how fishers exploit
multiple heterogeneously distributed fish populations with different catch
limits or conservation status requires detailed understanding of the overlap of
resources; this is difficult to achieve using conventional modelling approaches
due to species targeting in fisheries resulting in preferential sampling
\citep{Martinez-Minaya2018}. Often data are aggregated or extrapolated which
requires assumptions about the spatial and temporal scale of processes. Our
study explores the assumptions behind such aggregation and preferential
sampling to identify potential impacts on management advice. With modern
management approaches increasingly employing more nuanced spatio-temporal
approaches in order to maximise productivity while taking account of both the
biological and human processes operating on different time-frames
\citep{Dunn2016}, understanding assumptions behind the data used -
increasingly a combination of logbook and positional information from vessel
monitoring systems - is vital to ensure measures are effective. \\

%% our approach

We employ a simulation approach to model each of the population and fishery
processes in a hypothetical 'mixed fishery', allowing us to i) evaluate the
consequences of different aggregation assumptions on our understanding of the
spatio-temporal distribution of the underlying fish populations, and ii)
evaluate the effectiveness of a spatial closure given those assumptions. \\

%% USP

Our approach captures fine scale population and fishery dynamics and their
interaction in a way not usually possible with real data and thus not usually
considered in fisheries simulations. While other simulation frameworks seek to
model individual vessel dynamics based on inferred dynamics from VMS and
logbook records \citep{Bastardie2010}, or as a system to identify measures to
meet particular management goals \citep{Bailey2018}, our framework allows users
to explore the assumptions in modelling observational data and evaluate the
underlying dynamics of such approaches at a fine spatial and temporal scale.
This offers the advantage that larger scale fishery patterns are emergent
properties of the system rather and results can be compared to those obtained
under a statistical modelling framework. \\

%% Comparison to other models

COMPARE AGAINST OTHER MODELS: Osmose, Atlantis,... do they use rationale actors
and economic profit making ?

%% Why ours is important

Our results demonstrate the importance of data scale and resolution when using
observational data to support management measures. In doing so it highlights
depends on scale of process: pop movement etc... Important to consider how
fishers interact / adapt to changes with the resource and mgmt. \\

%% key findings in context

It seems clear that spatial disaggregation is more important than the temporal
disaggregation of the commercial data... WHY

Closure scenarios demonstrate potential tor reduce F - not as high as with real
pop, but good.  Make link to other studies -- read up on these. \\

\underline{The what next:} \\

Real world spatiotemp closures rarely been able to consider these issues /
designed with these issues fully in mind - NS cod closures, plaice and trevose
box... \\

Use of commercial data increasing - likely to become more important in future.
Also collaborative approach with industry, e.g. hotspot mapping, spatiotemp
advice... \\


Other potential uses of the model \\

Survey design - random, fixed, stratified - all possible to explore  \\

Assumptions in spatiotemporal models: GAMs, GLMMs, geostatistical models

Natural mortality estimation

Commercial index standardization methods - different spatial scales, individual
vessels, data aggregation -- all these can be explored. \\

Sampling scheme design \\

Testing fleet dynamics models at an aggregated level \\

Bigger picture stuff::  LO, increasing desire for more nuanced spatiotemp
mgmt... Wider applicability: birds, wildlife ?? 

\section{Conclusions}

Study shows ....\\

This is important because .... \\

How we might apply this in future .... \\

\section*{Abbreviations} Detail any unusual ones used.

\section*{Acknowledgements} those providing help during the research..

\section*{Funding} This work was supported by the MARES doctoral training
program (MARES\_14\_15) and the Centre for Environment, Fisheries and
Aquaculture Science seedcorn program (DP227AC).

\section*{Appendices}

\input{parameter_tables.tex}

\clearpage
\footnotesize
\input{F_changes.tex}


%%%% figures
\begin{figure}[!ht]
	\includegraphics[width=\linewidth]{../analysis/Data_Aggregation_space_Rev}
	\caption{Data aggregation at different spatial resolutions over a
		ten year period}
	\label{fig:1}
\end{figure}	

\begin{figure}[!ht]
	\includegraphics[width =\linewidth]{../analysis/Data_Aggregation_time_Rev}
	\caption{Data aggregation at different temporal resolutions over a
		ten-year period}
	\label{fig:2}
\end{figure}	


\begin{figure}[!ht]
	\includegraphics[width = \linewidth]{../analysis/F_trendsREV}
	\caption{Comparison of closure scenarios effect on fishing mortality
		trends. Line colour denotes the timescale, while linestyle
		denotes the spatial resolution.}
	\label{fig:3}
\end{figure}

\begin{figure}[!ht]
	\includegraphics[width =\linewidth]{../analysis/f_diff_effectiveness}
	\caption{Comparison of closure scenario effectiveness based on
		different spatial and temporal resolutions.}
	\label{fig:4}
\end{figure}	

\clearpage

\section*{References}

\bibliography{simulation_framework}

\end{document}
