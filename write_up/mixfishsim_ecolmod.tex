\documentclass[review]{elsarticle}

\usepackage{xr} %% For cross-referencing supl figures
\externaldocument[S-]{Supplementary}

\usepackage{lineno}
\usepackage[hidelinks]{hyperref}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{amsfonts}
\usepackage{mathtools}

%% for the annex figure
\usepackage{tikz}
\usetikzlibrary{shapes,arrows,chains,calc}
% Set up a few colours for tikz figure
\colorlet{lcfree}{green}
\colorlet{lcnorm}{blue}
\colorlet{lccong}{red}

\usepackage{hhline}
\usepackage{booktabs}
\usepackage{eurosym}
\usepackage{longtable}

\usepackage{enumitem}
\usepackage{comment}

\modulolinenumbers[1]

\journal{Ecological Modelling}

%% Harvard
\bibliographystyle{model2-names.bst}\biboptions{authoryear}
%%%%%%%%%%%%%%%%%%%%%%%
%% correct equation line numbering

\let\oldequation\equation
\let\oldendequation\endequation
\renewenvironment{equation}
 {\linenomathNonumbers\oldequation}
 {\oldendequation\endlinenomath}


%%%%%%%%%%%%%%%%%%%%%%



\begin{document}

\begin{frontmatter}
\title{Working title: Highly resolved spatiotemporal simulations for
	exploring mixed fishery dynamics}

%% Group authors per affiliation:
\author[1,2]{Paul J. Dolder\corref{c}}
\cortext[c]{Corresponding author}
\ead{paul.dolder@gmit.ie}

\author[1]{Cóilín Minto}
\author[3]{Jean-Marc Guarini}
\author[4,5]{Jan Jaap Poos}

\address[1]{Galway-Mayo Institute of Technology (GMIT), Dublin Road, Galway,
	Ireland} 
\address[2]{Centre for Environment, Fisheries and Aquaculture Science (Cefas),
	Pakefield Road, Lowestoft, UK}
\address[3]{Sorbonne Université, Faculty of Sciences, 4 Place Jussieu, 75005
	Paris, France}
\address[4]{Wageningen Marine Research, Haringkade 1 1976 CP IJmuiden,
	Netherlands}
\address[5]{Aquaculture and Fisheries Group, Wageningen University \& Research,
	Zodiac Building 122, De Elst 1, 6708 WD Wageningen, the Netherlands}


\begin{abstract}

%%
To understand how data resolution impacts inference on mixed fisheries
interactions we developed a highly resolved spatiotemporal discrete-event
simulation model incorporating: i) delay-difference population dynamics, ii)
population movement using Gaussian Random Fields to simulate patchy,
heterogeneously distributed populations, and iii) fishery dynamics for multiple
fleet characteristics based on population targeting under an explore-exploit
strategy. This is implemented via a mix of correlated random walk movement (for
exploration) and learned behaviour (for exploitation) phases of the fisheries. \\ 
%%
Fifty years of sub-daily fishing activity was simulated and used to draw
inference on the underlying community structures. We compared inferences based
on: commercial catch, a simulated fixed-site sampling survey design and the
true underlying populations. We i) establish the potential limitations of
fishery-dependent data in providing a robust picture of spatiotemporal
distributions; and then ii) simulated an area closure based on areas defined
from the different data sources at a range of temporal and spatial resolutions.\\
%%
Our framework allows users to explore the assumptions in modelling
observational data and evaluate the underlying dynamics of such approaches at a
fine spatial and temporal scale. In application to a mixed fishery exploiting
four different populations we found different spatial patterns were evident and
that the effectiveness of the spatial closure reduced when data were aggregated
across larger spatial areas. However, aggregation across time periods has less
of a negative impact on the closure success and while not as effective as when
based on on the true population, closures based on high catch rates observed in
commercial data could still reduce fishing on a protected species. \\ 

We conclude from our example framework application that commercial data, while
containing bias, provide a useful tool for managing catches in mixed fisheries
if applied at the correct spatiotemporal scale. \\
%%
\end{abstract}

\begin{keyword}
Some\sep keywords \sep here. Max 6 
\MSC[2010] 00-01\sep  99-00
\end{keyword}

\end{frontmatter}

\linenumbers

\section{Introduction}

Fishers exploit a variety of fish populations that are heterogeneously
distributed in space and time with varying knowledge of species distributions.
As fishers do not have full control over what species they select when fishing
in `mixed fisheries' it can result in catch of low quota or protected species.
If over-quota catch of a species for which they have no quota is discarded
without being accounted for it limits our ability to control fishing mortality
\citep{Alverson1994, Crowder1998, Rijnsdorp2007} and the ability to manage
fisheries for the biological and economic sustainability \citep{Ulrich2011a,
	Batsleer2015}.\\

There is increasing interest in technical solutions such as gear and spatial
closures as measures to reduce unwanted catch \citep{Kennelly2002,
	Catchpole2008, Bellido2011, Cosgrove2019} and adaptive spatial
management strategies have been proposed as a way of reducing over-quota
discards \citep{Holmes2011, Little2014, Dunn2014a}. However, if fisheries are
to reduce unwanted catch through spatial avoidance, an in-depth understanding
of spatiotemporal fishery dynamics is required. \\

Understanding the correct scale for spatial management measures to be effective
is crucial as it enables implementation of effective solutions which minimise
economic impact \citep{Dunn2016}. For example, the problem can be to identify a
scale that promotes species avoidance for vulnerable or low quota species while
allowing continuance of sustainable fisheries for available quota species.
Identifying the correct spatial scale remains a challenge because data on fish
location at high temporal and spatial resolutions is expensive and difficult to
collect and proxies are usually inferred from scientific surveys or commercial
catches with limited spatial and temporal resolution. Thus, implementation of
spatial measures is hampered by a lack of knowledge of fish and fishery
spatiotemporal dynamics and understanding of the scale at which these processes
become important for management. \\ \\ 

Identifying appropriate spatial scales for fisheries closures has been a
highlighted as crucial to their success \citep{Costello2010, Dunn2016}.
Inference on fisheries spatial dynamics is hampered where spatial information
is coarse due to low resolution reporting of fisheries catch which is
aggregated across larger gridded areas \citep{Branch2005}. Further, if data
does not allow identification of spatial features it may lead to poorly sited
closures which are ineffectual or have unintended consequences. For example,
increased benthic impact on previously unexploited areas from the cod closure
in the North Sea were observed without the intended effect of reducing cod
exploitation \citep{Rijnsdorp2001,Dinmore2003}).\\ 

More refined spatiotemporal information has since become available through the
combination of logbook and Vessel Monitoring System (VMS) data \citep{Lee2010,
	Bastardie2010, Gerritsen2012, Mateo2016} and more real-time spatial
management has been possible \citep[e.g.][]{Holmes2011}.  However, fishers
establish favoured fishing grounds through an explore-exploit strategy
\citep{Rijnsdorp2011, Bailey2018} where they search for areas with high catches
and then use experience to return to areas where they've experienced high catch
in the past.  This leads to an inherently biased sampling where target species
are over-represented in the catch as fishers exploit areas of high abundance.
There is a need to understand the influence of these biases on any spatial
management measures which are implemented based on inference from commercial
landings or catch data. \\ 

To understand the effect of spatiotemporal aggregation of data and fishery
targeting on our perception of spatial abundance of different fish populations
we ask two fundamental questions regarding inference derived from observational
data:

\begin{enumerate}
	\item Do different source of sampling-derived fisheries data
		reflects the underlying community structure? 	
	\item How does data aggregation and data source impact on the success
		of spatial fisheries management measures?
\end{enumerate}
	
To answer these questions we i) develop a simulation model where population
dynamics are highly-resolved in space and time, using a Gaussian spatial
process to define suitable habitat for different populations. As the precise
locations of the fish are known directly rather than inferred from sampling
or commercial catch, we can use the population model to validate how inference
from fisheries-dependent and fisheries independent sampling relates to the real
community structure in a way we could not with real data. We ii) compare, at
different spatial and temporal aggregations, the real (simulated) population
distributions to samples from fisheries-dependent and fisheries independent
catches to test if these are a true reflection of the relative density of the
populations. We then iii) simulate a fishery closure to protect a species based
on different spatial and temporal data aggregations. \\

We use these evaluations to draw inference on the utility of commercial data in
supporting management decisions.  

\section{Materials and Methods}

A Discrete-event simulation (DES) model of a hypothetical fishery was developed
as a software package (\textit{MixFishSim}). The modular approach enabled
efficient computation by allowing for sub-modules implemented on time-scales
appropriate to capture the characteristic of the different processes (Figure
1). The following sub-modules were included to capture the full system: 1)
Population dynamics, 2) Recruitment dynamics, 3) Population movement, 4)
fishery dynamics.\\

Population dynamics operate on a daily time-step, while population movement
occurs on a weekly time-step, with the fishing module operating on a tow-by-tow
basis (i.e.  multiple events a day). 

\subsection{Population dynamics}

The basic population level processes were simulated using a modified two-stage
Deriso-Schnute delay difference model which models the fish populations in
terms of aggregate biomass of recruits and mature components rather than
keeping track of individuals\citep{Deriso1980, Schnute1985, Dichmont2003}. A
daily time-step was chosen to discretise continuous population processes on a
biologically relevant and computationally tractable timescale. Population
biomass growth was modelled as a function of previous recruited biomass,
intrinsic population growth and recruitment functionally linked to the adult
population size.  Biomass for each cell $c$ was incremented each day $d$ as
follows (the full parameter list is detailed in Table \ref{tab: pop_variable}): 
\begin{equation}
	\begin{split}
	B_{c,d+1} = &\\
	& \left(1 + \rho \right) B_{c,d} \cdot \mathrm{e}^{-Z_{c,d}} - \rho \cdot
	\mathrm{e}^{-Z_{c,d}} \hspace{2.9cm}
	\times \\  
	& \left(B_{c,d-1} \cdot \mathrm{e}^{-Z_{c,d-1}} + Wt_{R-1} \cdot \left( \alpha_{d-1} \cdot
	R_{\tilde{y}(c)}\right) \right)
	\hspace{0.9cm} + \\
	& Wt_{R} \cdot \left( \alpha_{d} \cdot R_{\tilde{y}(c) \right)}
	\end{split}
\end{equation}
where $\rho$ is Brody's coefficient, shown to be equal to $\mathrm{e}^{-K}$
when $K$ is the growth rate from a von Bertalanffy logistic growth model
\citep{Schnute1985}. $Wt_{R-1}$ is the average weight of fish prior to
recruitment, while $Wt_{R}$ is the average recruited weight. $\alpha_{d}$
represents the proportion of fish recruited during that day for the year, while
$R_{c,\tilde{y}(c)}$ is the annual recruits in year $y$ for cell $c$. \\

Mortality $Z_{c,d}$ can be decomposed to natural mortality, $M_{c,d}$, and
fishing mortality, $F_{c,d}$, where both $M_{c,d}$ and $F_{c,d}$ are
instantaneous rates with $M_{c,d}$ fixed and $F_{c,d}$ calculated by solving
the Baranov catch equation \citep{Hilborn1992b} for $F_{c,d}$:
\begin{equation}
C_{c,d} = \frac{F_{c,d}}{F_{c,d} + M_{c,d}} \cdot \left(1 -
	\mathrm{e}^{-(F_{c,d} + M_{c,d})}\right) \cdot B_{c,d}
\end{equation}
where $C_{c,d}$ is the summed catch from the fishing model across all fleets
and vessels in cell $c$ for the population during the day $d$, and $B_{c,d}$
the daily biomass for the population in the cell. Here, catch is the sum of
those across all fleets and vessels, $C_{c, d} =
\sum\limits_{fl=1}^{FL}\sum\limits_{v=1}^{V} E_{fl, v, c, d} \cdot Q_{fl} \cdot
D_{c, d}$ with $fl$ and $v$ the fleet and vessel respectively and
$E_{fl,v,c,d}$ and $Q_{fl}$ fishing effort and catchability of the gear, and
$D_{c,d}$ is the density of the population at the location fished. \\

\subsection{Recruitment dynamics}

Recruitment is modelled as a function of adult biomass. In
\textit{MixFishSim}, it can either take the form of a stochastic Beverton-Holt
stock recruitment relationship, or a stochastic Ricker stock recruitment
relationship. The Beverton-Holt relationship is defined as\citep{Beverton1957}: 
\begin{equation}
	\begin{split}
	\bar{R}_{c,d} = & \frac{(\alpha \cdot S_{c,d})}{(\beta + S_{c,d})} \\
	     R_{c,d} \sim & \log N[(\log(\bar{R}_{c,d}),\sigma^2)]
	\end{split}
\end{equation}
where $\alpha$ is the maximum recruitment rate, $\beta$ the spawning stock
biomass (SSB) required to produce half the maximum stock size, $S$ current
stock size and $\sigma^2$ the variability in the recruitment due to stochastic
processes. The stochastic Ricker form \citep{Ricker1954} is:
\begin{equation}
	\begin{split}
	\bar{R}_{c,d} = & B_{c,d} \cdot \mathrm{e}^{(\alpha - \beta \cdot B_{c,d})} \\	
   	     R_{c,d} \sim & \log N[(\log(\bar{R}_{c,d}),\log(\sigma^2))]
	\end{split}
\end{equation}
where $\alpha$ is the maximum productivity per spawner and $\beta$ the density
dependent reduction in productivity as the SSB increases. 

\subsection{Population movement dynamics}

Population movement is a combination of directed (advective) movement where at
certain times of year the population moves towards spawning grounds by
increasing the probabilities of moving into the spawning grounds from adjacent
cells, and random (diffusive) movement, governed by a stochastic process where
movement between adjacent cells is described by a set of probabilities.\\

To simulate fish population distribution in space and time a Gaussian spatial
process was employed to model habitat suitability for each of the populations
on a 2d grid.  We first defined a Gaussian random field process, $\{S(c) : c \in
\mathbb{R}^2\}$, where for any set of cells $c_{1}, \dots, c_{n}$, the joint
distribution of $S = \{S(c1),\dots S(c_{n})\}$ is multivariate Gaussian with a
\textit{Matérn} covariance structure, where the correlation strength weakens
with distance. This enables us to model the spatial autocorrelation observed in
animal populations where density is more similar in nearby locations
\citep{Tobler1970, F.Dormann2007, Poos2007} and we change the parameters to
implement different spatial structures for the different populations using the
\textit{RandomFields} R package \citep{Schlater2015}. We define a stationary
habitat field and combine it with a temporally dynamic thermal tolerance field to
imitate two key drivers of population dynamics. Each population was initialised
at a single location, and subsequently moved across the entire space according
to a probabilistic distribution based on habitat suitability (represented by
the normalised values
from the GRFs), temperature and distance from current cell: 
\begin{equation}
	Pr(C_{wk+1} = J | C_{wk} =I) = \frac{\mathrm{e}^{-\lambda \cdot d_{I,J}} \cdot
		(Hab_{J,p}^2 \cdot
		Tol_{J,p,wk})}{\sum\limits_{c=1}^{C}\mathrm{e}^{-\lambda \cdot d} \cdot
		(Hab_{c,p}^2 \cdot Tol_{c,p,wk})}
\end{equation}
Where $d_{I,J}$ is the euclidean distance between cell $I$ and cell $J$,
$\lambda$ is a given rate of decay, $Hab_{c,p}^2$ is the squared index of
habitat suitability for cell $c$ and population $p$, with $Tol_{c,p,wk}$ the
temperature tolerance for cell $c$ by population $p$ in week $wk$ (see
below). \\

During pre-defined weeks of the year the habitat suitability is modified with
user-defined spawning habitat locations, resulting in each population having
concentrated areas where spawning takes place. The populations then move
towards these cells in the weeks prior to spawning, resulting in directional
movement towards the spawning grounds. \\

A time-varying temperature covariate changes the interaction between time and
suitable habitat on a weekly time-step. Each population $p$ was assigned a
thermal tolerance with mean, $\mu_{p}$ and variance, $\sigma^2_{p}$ so that
each cell and population temperature suitability is defined that:
\begin{equation}
	Tol_{c, p, wk} = \frac{1}{ \sqrt (2\pi \cdot \sigma^2_{p})} \cdot \exp(-
		\frac{(T_{c, wk} - \mu_{p})^2}{2 \cdot \sigma^2_{p}} )	
\end{equation}
Where $Tol_{c, p, wk}$ is the tolerance of population $p$ for cell $c$ in week
$wk$, $T_{c, wk}$ is the temperature in the cell given the week and $\mu_{p}$
and $\sigma^2_{p}$ the mean and standard deviation of the population
temperature tolerance. \\

The final combined process results in a population structure and movement
pattern unique to each population, with population movement occurring on a weekly
basis. The decision to model population movement on a weekly timescale was to
reflect that fish tend to aggregate in species specific locations that have
been observed to last around one to two weeks \citep{Poos2007}. Therefore this
process approximated the demographic shifts in fish populations throughout a
year with seasonal spawning patterns (Figure \ref{S-fig:5}).

\subsection{Fleet dynamics}

Fleet dynamics can be broadly categorised into three components: fleet
targeting - that determined the fleet catch efficiency and preference towards a
particular population; trip-level decisions, that determines the initial location
to be fished at the beginning of a trip; and within-trip decisions, that
determines movement from one fishing spot to another within a trip. An
explore-exploit type strategy was implemented in the model that combined these
three components for individual vessels to maximise their catch from an unknown
resource distribution \citep{Bailey2018}. The decision to use an individual
based model for fishing vessels was taken because fishers are heterogeneous in
their location choice behaviour due to different objectives, risk preference
and targeting preference \citep{VanPutten2012a, Boonstra2015}. Therefore fleet
dynamics are emergent from individual dynamics rather than pre-defined group
dynamics. 

\subsubsection{Fleet targeting}

Each fleet of \textit{n} vessels was characterised by both a general
efficiency, $Q_{fl}$, and a population specific efficiency, ${Q_{fl, p}}$ which
are each bound by [0,1]. The product of these parameters [$Q_{fl} \cdot
Q_{fl, p}$] affects the overall catch rates for the fleet and the preferential
targeting of one species over another. This, in combination with the
parameter choice for the step-function defined below (as well as some
randomness from the exploratory fishing process) determined the preference of
fishing locations for the fleet.  

\subsubsection{Decision about where to fish at the start of the trip}

Several studies \citep[for a review]{Girardin2016} have confirmed past activity
and past catch rates are strong predictors of fishing location choice. For this
reason, the fleet dynamics sub-model included a learning component, where a
vessel's initial fishing location in a trip was based on selecting from
previously successful fishing locations. This was achieved by calculating an
expected revenue based on the catches from locations fished in the preceding
trip as well as the same month periods in previous years and the travel costs
from the port to the fishing grounds. Then a vessel chooses randomly from the
top 75 \% of fishing events as defined by the expected profit, that has a
seasonal component. 

\subsubsection{Decision about where to fish within the trip}

Fishing locations within a trip are initially determined by a modified random
walk process. As the simulation progresses the within-trip decision become
gradually more influenced by experience gained from past fishing locations (as
per the initial trip-level location choice), moving location choice towards
areas of higher perceived profit. A random walk was chosen for the exploratory
fishing process as it is the simplest assumption commonly used in ecology to
describe optimal animal search strategy for exploiting heterogeneously
distributed prey about which there is uncertain knowledge
\citep{Viswanathan1999}. In a random walk, movement is a stochastic process
through a series of steps. These steps have a length, and a direction that can
either be equal in length or take some other functional form. The direction of
the random walk was also correlated (known as `persistence') providing some
overall directional movement \citep{Codling2008}. \\

For our implementation of a random walk directional change is based on a
negatively correlated circular distribution where a favourable fishing ground
is likely to be ``fished back over" by the vessel returning in the direction it
came from.  The step length (i.e. the distance travelled from the current to
the next fishing location) is determined by relating recent
fishing success, measured as the summed value of fish caught (revenue, $Rev$);
\begin{equation}
Rev_{c,d} = \sum_{p=1}^{P} L_{c,d,p} \cdot Pr_{p} 
\end{equation}
where $L_{c,d,p}$ is landings of a population $p$, and $Pr_{p}$ price of a
population. All population prices were kept the same across fleets and seasons.
Here, when fishing is successful vessels remain in a similar location and
continue to exploit the local fishing grounds. When unsuccessful, they move
some distance away from the current fishing location.  The movement distance
retains some degree of stochasticity, that can be controlled separately, but is
determined by the relationship: 
\begin{equation}
	Le = \mathrm{e}^{log(\beta_{1}) + log(\beta_{2}) -
		\left(log\left(\frac{\beta_{1}}{\beta_{3}}\right)\right) \cdot Rev
} 
\end{equation}
Where $\beta_{1}$, $\beta_{2}$ and $\beta_{3}$ are parameters determining the
shape of the step function in its relation to revenue, so that, a step from
(x1,y1) to (x2, y2) is defined by:
\begin{equation}
	\begin{split}
 (x2, y2) =  & x1 + Le \cdot \cos \left(\frac{\pi \cdot Br}{180}\right), \\
             & y1 + Le \cdot \sin \left(\frac{\pi \cdot Br}{180}\right) \\	
 with  \hspace{0.5cm}     & Br_{t-1} < 180, Br_{t} = 180 + \sim vm[(0,360), k] \\
 			  & Br_{t-1} > 180, Br_{t} = 180 - \sim vm[(0,360), k] \\
	\end{split}
\end{equation}
where $Le$ is the step length, $k$ the concentration parameter from the von
Mises distribution that we correlate with the revenue so that $k = (Rev + 1 /
RefRev) \cdot max_{k}$, where $max_{k}$ is the maximum concentration value,
$k$, and $RefRev$ is parametrised as for $\beta_{3}$ in the step length
function. 

\subsubsection{Local population depletion}

Where several fishing vessels exploit the same fish population competition is
known to play an important role in local distribution of fishing effort
\citep{Gillis1998}. If several vessels are fishing on the same patch of fish,
local depletion and interference competition will affect fishing location
choice of the fleet as a whole \citep{Rijnsdorp2000, Poos2007a}.  To account
for this behaviour, the fishing sub-model operates spatially on a daily
time-step so that for future days the biomass available to the fishery is
reduced in the areas fished. The cumulative effect is to make heavily fished
areas less attractive as a future fishing location choice as reduced catch
rates will be experienced. 

\subsection{Fisheries independent survey}

A fisheries-independent survey is simulated where fishing on a regular grid
begins each year at the same time for a given number of stations (a fixed
station survey design). Catches of the populations at each station are recorded
but not removed from the population (catches are assumed to have negligible
impact on population dynamics). This provides a fishery independent snapshot of
the populations at a regular spatial intervals each year, similar to scientific
surveys undertaken by fisheries research agencies. \\

\subsection{Software: R-package development}

The simulation framework is implemented in the statistical software package R
\citep{RCoreTeam2017} and available as an R package from the author's github
site (\url{www.github.com/pdolder/MixFishSim}).\\

\section{Parameterisation}
We parameterise \textit{MixFishSim} to investigate the influence of data
aggregation on spatial inference.

\subsection{Population models}

We parametrised the simulation model for four example populations with
different demographics, growth rates, natural mortality and recruitment
parameters (Table \ref{tab:1}). Habitat preference (Figure \ref{S-fig:1}) and
temperature tolerances (Figures \ref{S-fig:3}, \ref{S-fig:4}) were defined to
be unique to each population resulting in differently weekly distribution
patterns (Figures \ref{S-fig:5}-\ref{S-fig:7}). In addition, each of the
populations was assumed to have two defined spawning areas that result in the
populations moving towards these areas in pre-defined weeks (Figure
\ref{S-fig:2}) with population-specific movement rates (Table \ref{tab:1}).

\subsection{Fleet parametrisation}

The fleets were parametrised to reflect five different characteristic fisheries
with unique exploitation dynamics (Table \ref{tab:2}). By setting different
catchability parameters ($Q_{fl, p}$) we create different targeting preferences
between the fleets and hence spatial dynamics.  The learned random walk process
implies that within a fleet different vessels have different spatial
distributions based on individual experience. The step function was
parametrised dynamically within the simulations as the maximum revenue
obtainable was not known beforehand. This was implemented so that vessels take
smaller steps when fishing at a location that yields landings value in the top
90th percentile of the value experienced in that year so far (as defined per
fleet in Table \ref{tab:2}). \\

Fishing locations were chosen based on random search and, with increasing
proportion as time progressed, experience of profitable catches built up in the
same month from previous years and from the previous trip.  'Profitable' in
this context was defined as the locations where the top 70 \% of expected
profit would be found given revenue from previous trips and cost of movement to
the new fishing location. This probability was based on a logistic sigmoid
function with a lower asymptote of 0 and upper asymptote of 0.95, and a growth
rate that ensures the upper asymptote (where decisions are mainly based on past
knowledge) is reached approximately halfway through the simulation.  \\


\subsection{Survey settings}

The survey simulation was set up with a fixed gridded station design with 100
stations fished each year, starting on day 92 and ending on day 112 (5 stations
per day) with same catchability parameter ($Q_{p} = 1$) for all populations $p$.
This approximates a real world survey design with limited seasonal and spatial
coverage. 

\subsection{Example research question}

To illustrate the capabilities of \textit{MixFishSim}, we investigate the
influence of the temporal and spatial resolution of different data sources on
the reduction in catches of a population given spatial closures. To do so, we
set up a simulation to run for 50 years based on a 100 $\times$ 100 square grid
(undetermined units), with five fleets of 20 vessels each and four fish
populations. Fishing takes place four times a day per vessel and five days a
week, while population movement is every week. \\

\textit{How does sampling-derived fisheries data reflect the underlying
	population structure?} \\

To answer this question we compare different spatial and temporal aggregations
of the true population distributions to:
\begin{enumerate}[label=\alph*)]
	\item \textbf{fisheries-independent data:} the inferred population
		density from a fixed-site sampling survey design as commonly
		used for
		fisheries monitoring purposes;
	\item \textbf{fisheries-dependent data:} the inferred population
		density from our fleet model that includes fishery-induced
		sampling dynamics.
\end{enumerate}

We allow the simulation to run unrestricted for 30 years, then implement
spatial closed areas for the last 20 years of the simulation based on data
(either derived from the commercial catches, fisheries-independent survey or
the true population used at different spatial and temporal scales. \\

The following steps are undertaken to determine closures:

\begin{enumerate}
	\item Extract data source (true population, commercial or survey), 
	\item Aggregate according to desired spatial and temporal resolution,
	\item Interpolate across entire area at desired resolution using simple
		bivariate interpolation using the \emph{interp} function from
		the R package akima \citep{Akima2006}. This is intended to
		represent a naive spatial model of catch rates, without
		knowledge of the spatial population dynamics.
	\item Close area covering top 5 \% of catch rates 
\end{enumerate}
In total 28 closure scenarios were run that represent combinations of:

\begin{itemize}
	\item \textbf{data types:} commercial logbook data, survey data and
		true population,
	\item \textbf{temporal resolutions:} weekly, monthly and yearly
		closures,
	\item \textbf{spatial resolutions:} 1 x 1 grid, 5 x 5 grid, 10 x 10
		grid and 20 x 20 grid,
	\item \textbf{closure basis:} highest 5 \%  of catch rates for the
		protected population
\end{itemize}

Survey closures were on an annual basis only, as this was the most temporally
resolved survey data available.

\section{Results}

\subsection{Emergent simulation dynamics}

Individual habitat preferences and thermal tolerances result in different
spatial habitat use for each population (Figure \ref{fig:9}) and consequently
different seasonal exploitation patterns (Figure \ref{fig:10}). 

It can be seen from a single vessels movements during a trip that the vessel
exploits three different fishing grounds, each of them multiple times (Figure
\ref{fig:mv}(A)), while across several trips fishing grounds that are further
apart are fished (Figure \ref{fig:mv} (B)). These different locations relate to
areas where the highest revenue were experienced, as shown by Figure
\ref{fig:mv} (D), where several vessels tracks are overlaid on the revenue
field, i.e. $$Rev_{c} = \sum^P_{p=1} B_{c,p} \cdot Q_{fl,p} \cdot Pr_{p}$$

Vessels from the same fleet (and therefore targeting preference) may exploit
some shared and some different fishing grounds depending on their own personal
experience during the exploratory phase of the fishery (Figure \ref{fig:mv} (C)).
This results from the randomness in the correlated random walk step function,
with distance moved during the exploitation phase and the direction
stochastically related to the revenue experienced on the fishing ground (Figure
\ref{fig:mv} (D)). 

\subsection{How does sampling-derived fisheries data reflect the underlying
	population structure?}

The aggregated catch composition from each of the data sources over a ten-year
period (which shows average seasonal patterns) at different spatial resolutions
highlights different patterns in perceived community structure depending on the
data source and aggregation level (Figure \ref{fig:1}). The finer spatial grid
for the true population (top left) and commercial data (top middle) show
visually similar patterns, though there are large unsampled areas in the
commercial data from a lack of fishing activity (particularly in the lower left
part of the sampling domain). The survey data at this spatial resolution
displays very sparse information about the spatial distributions of the
populations. The slightly aggregated data on a 5 x 5 grid shows similar
patterns and, while losing some of the spatial detail, there remains good
consistency between the true population and the commercial data. Survey data
starts to pick out some of the similar patterns as the other data sources, but
lacks spatiotemporal coverage. The spatial catch information on a 10 x 10 and
20 x 20 grid lose a significant amount of information about the spatial
resolutions for all data sources, and some differences between the survey,
commercial and true population data emerge. \\

Different perceptions of the proportion of each stock in an area are seen when
we aggregate the data over a smaller geographical region at different
timescales, with weekly (top), monthly (middle) and yearly (bottom) catch
compositions from across an aggregated 20 x 20 area (Figure \ref{fig:2}). In
the true population, the monthly aggregation captures the major patterns of
composition seen in the weekly data with the percentage of different
populations in the catch having similar mean and standard deviations.  In the
weekly data population 1 = 9.36 (3.99), population 2 = 83.2 (5.60), population
3 = 3.57 (1.23), population 4 = 3.91 (1.59); in the monthly data population 1 =
9.23 (3.87), population 2 = 83.3 (5.52), population 3 = 3.62 (1.15), population
4 = 3.86 (1.52). While means were similar some of the variation was lost when
aggregated to an annual level; population 1 = 9.90 (0.173), population 2 = 82.2
(0.308), population 3 = 3.82 (0.119), population 4 = 4.03 (0.0502).\\

The commercial data on a weekly basis shows some of the same patterns as the
true population, though the population 1 (in red) is less well represented and
some weeks are missing catches from the area. Here, weekly and monthly
compositions were nearly identical, with monthly composition of population 1 =
0.0472 (0.0139), population 2 = 94.4 (1.47), population 3 = 3.12 (1.47),
population 4 = 2.40 (0.444). Again, yearly values head a similar mean but
smaller standard deviation.\\

The survey data was only available on an annual basis, and showed again a
slightly different composition; population 1 = 0.372 (0.00473), population 2 =
87.7 (0.193), population 3 = 0.729 (0.0200), population 4 = 11.2 (0.172).

\subsection{How does data aggregation and source impact on spatial fisheries
	management measures?}

We implemented a spatial closure using the different data sources and spatial
and temporal aggregations as outlined in the protocol in Section 3.4. We used
this to assess the efficacy of a closure in reducing fishing mortality on
population 3, given availability of data and its use at different resolutions in
order to evaluate the trade-offs in data sources. 

The trend in fishing mortality for each species show that in most cases the
fishery closure was successful in reducing fishing mortality on the species of
interest (population 3; Figure \ref{fig:3}), though interestingly the largest
reductions in fishing mortality happened immediately after the closures,
following which the fisheries ``adapted" to the closures and fishing mortality
increased again somewhat. The exception to the success was the closures
implemented based on the coarsest spatial (20 x 20) and temporal resolution
(yearly) that was ineffective with all data sources. As expected, closures
based on the ``known" population distribution were most effective, with
differing degrees of success using the commercial data. Fishing mortality rates
on the other species changed in different proportions, depending on whether the
displaced fishing effort moved to areas where the populations were found in
greater or lesser density. \\

A regression tree (using the R package REEMtree \citep{Sela2012}) highlights
that the factor most contributing to differences in fishing mortality before
and after the closure was the population (72 \% showing that the closures were
effective for population 3), followed by data resolution (21 \%), data type (7
\%) with the least important factor the timescale ($<$ 1 \%). In general the
finer the spatial resolution of the data used the greater reduction in fishing
mortality for population 3 after the closures (Figure \ref{fig:4}). The notable
outliers are the commercial data at the coarsest spatial resolution (20 x 20)
at a yearly and weekly timescale, where closures were nearly as effective as
the fine-scale resolution. In this case the closures were sufficiently large to
protect a core area of the habitat for the population, but this was achieved in
a fairly crude manner by closing a large area - including area where the
species was not found (Figure \ref{fig:17}) that may have consequences in terms
of restricting the fishery in a much larger area than necessary. \\

\section{Discussion}

%% General intro
Our study presents a new highly resolved fisheries simulation framework,
evaluates the importance of data scaling and considers potential bias
introduced through data aggregation when using fisheries data to infer
spatiotemporal dynamics of fish populations. Understanding how fishers exploit
multiple heterogeneously distributed fish populations with different catch
limits or conservation status requires detailed understanding of the overlap of
resources; this is difficult to achieve using conventional modelling approaches
due to species targeting in fisheries resulting in preferential sampling
\citep{Martinez-Minaya2018}. Often data are aggregated or extrapolated which
requires assumptions about the spatial and temporal scale of processes. Our
study explores the assumptions behind such aggregation and preferential
sampling to identify potential impacts on management advice. With modern
management approaches increasingly employing more nuanced spatiotemporal
approaches to maximise productivity while taking account of both the biological
and human processes operating on different time-frames \citep{Dunn2016},
understanding assumptions behind the data used - increasingly a combination of
logbook and positional information from vessel monitoring systems - is vital to
ensure measures are effective. \\

\subsection{Simulation dynamics}
 
We employ a simulation approach to model each of the population and fishery
dynamics in a hypothetical `mixed fishery', allowing us to i) evaluate the
consequences of different aggregation assumptions on our understanding of the
spatiotemporal distribution of the underlying fish populations, and ii)
evaluate the effectiveness of a spatial closure given those assumptions. \\

%% USP
Our approach is unique in that it captures fine scale population and fishery
dynamics and their interaction in a way not usually possible with real data and
thus not usually considered in fisheries simulations. While other simulation
frameworks seek to model individual vessel dynamics based on inferred dynamics
from VMS and logbook records \citep{Bastardie2010}, or as a system to identify
measures to meet particular management goals \citep{Bailey2018}, our framework
allows users to explore the assumptions in modelling observational data and
evaluate the underlying dynamics of such approaches at a fine spatial and
temporal scale.  This offers the advantage that larger scale fishery patterns
are emergent properties of the system and results can be compared to those
obtained under a statistical modelling framework. \\

%% Comparison to other models
Typically, simulation models that treat fish as individuals are focussed on
exploring the inter- and intra- specific interactions among fish populations
(e.g. OSMOSE; \cite{Shin2004}) in order to understand how they vary over space
and time. Our focus was on understanding the strengths and limitations of
inference from catch data obtained through commercial fishing activity with
fleets exploiting multiple fish populations and realising catch distributions
that may differ from the underlying populations, as identified by
\cite{Gillis2008}. As such, we favoured a minimum realistic model of the fish
populations \citep{Plaganyi2014} taking account of environmental but not
demographic stochasticity, while incorporating detailed fishing dynamics that
take account of different drivers in a mechanistic way.  \\ 

Demographic stochasticity arises due to individual-level variability in time to
reproduction and death. This form of stochasticity is often modelled by drawing
random time intervals from a given distribution \citep{Gillespie1977}. The
impact of demographic stochasticity depends on the population size, with the
effects expected to decrease with increasing population size \citep{Lande2010}.
This contrasts with environmental stochasticity, which affects all population
sizes and is present at the population level in our model by variability in
recruitment. \\

We take account of heterogeneity in fleet dynamics due to different preferences
and drivers similarly to other approaches \citep{Fulton2011}, but at an
individual vessel rather than fleet level. We do not explicitly define fleets
as rational profit maximisers at the outset, but consider there are several
stages to development of the fishery; information gathering through search
where the resource location is not known, followed by individual learnt
behaviour of profitable locations.  This provides a realistic model of how
fishing patterns are established and maintained to exploit an uncertain
resource through an explore-exploit strategy \citep{Mangel1983, Bailey2018}. 

\subsection{How does sampling-derived fisheries data reflect the underlying
	population structure?}

%% Why ours is important

Our results demonstrate the importance of considering data scale and resolution
when using observational data to support management measures. We find that
understanding of the community composition dynamics will depend on the level of
data aggregation and its important to consider the scale of processes;
including population movement rates, habitat uniformity and fishing targeting
practices if potential biases in data are to be understood and taken into
account (Figures \ref{fig:9}, \ref{fig:mv}). \\

Our simulation shows that, despite biases introduced through the fishing
process, the commercially derived data could still inform on the key spatial
patterns in the community structures where the fisheries occurred, which was
spatially limited due to the ``hotspots" of commercially valuable species being
fished. Similarly, despite the even spatial coverage the survey was able to
capture some of the same spatial patterns as the true population, but missed
others due to gaps between survey stations limiting spatial and temporal
coverage (Figure \ref{fig:1}). This provides a challenge when
modelling unsampled areas in inferring species distribution maps, though these
limitations may be overcome by understanding the relationship between the
species and habitat covariates where these are known at unsampled locations
\citep{Robinson2011}. \\ 

%% key findings in context
\subsection{How does data aggregation and source impact on spatial fisheries
	management measures?}

From our simulations spatial disaggregation was more important than the
temporal disaggregation of the commercial data. This reflects the fact that
there was greater spatial heterogeneity over the spatial domain than
experienced in individual locations over the course of the year (Figure
\ref{fig:9}). \\ 

The yearly data assumes the same proportion of each population caught at any
time of the year due to the data aggregation. This assumption introduces
`aggregation bias' as the data may only be representative of some point (or no
point) in time. The monthly data shows some consistency between the real
population and commercial data for population 2 - 4, though population 1 remains
under-represented.  On an annual basis, interestingly the commercial data under
represents the first species (in red) while the survey over represents species
1. This is likely due to the biases in commercial sampling, with the fisheries
not targeting the areas where population 1 are present and the survey sampling
areas where population 1 is more abundant than on average. This indicates that
fixed closures, at the right resolution, when based on commercially derived
data have the potential to reduced fishing mortality. The likely cost of poor
spatial and temporal resolution is associated with reduced effectiveness and
potentially closing fishing opportunities for other fisheries. \\

Two contrasting real world approaches in this respect were the spatial closures
to protect cod in the North Sea. In one example, large scale spatial closures
were implemented with little success due to effort displacement to previously
unfished areas \citep{Dinmore2003}, while in another small scale targeted
spatiotemporal closures were considered to have some effect in reducing cod
mortality without having to disrupt other fisheries significantly
\citep{Needle2011}. These examples emphasise the importance of considering the
right scale and aggregation of data when identifying area closures and the need
to consider changing dynamics in the fisheries in response to such closures. \\

Our study showed that fishing rates on other populations also changed (both up
and down) as a side-effect of closures to protect one species.  This indicates
the importance in considering fishing effort reallocation following spatial
closures, and our simulation allows us to consider the spatiotemporal reasons
for these changes.

\subsection{Model assumptions and caveats}

We model the population and fleet dynamic processes to draw inference on the
importance of data scale and aggregation in understanding and managing mixed
fisheries and their impact on multiple fish populations. In doing so, we have
necessarily had to make a number of simplifying assumptions. \\

Fish populations in our simulations move in pre-defined timescales and
according to fixed habitat preferences and temperature gradients (Figures
\ref{S-fig:1}, \ref{S-fig:3}). Our assumptions in parameterising the model
(movement rates, temperature tolerances) will have a direct impact on our
conclusions on the relative importance of spatial and temporal processes. These
assumptions could be explored in a future study by varying the parameters and
assessing the robustness of our conclusions. For our example application we
have chosen movement rates to reflect aggregation periods observed in past
studies \citep{Poos2007}. \\

In addition, we have assumed that fishing vessels are not restricted by quota
and therefore discarding of species for which vessels have no quota or that are
unwanted is not taken into account. This is likely to be a significant source
of bias in any inference using commercial data and should also be explored. For
example, \textit{MixFishSim} could be altered to allow for spatiotemporal
appraisal of the impact of discarding on fisher behaviour and underlying
populations via inclusion as discarding behaviour, or through move-on rules or
cessation of fishing activity when quota is exhausted. \\

\subsection{Future applications of \textit{MixFishSim}}

We consider that the increased availability of high resolution catch and
locational information from commercial fisheries will require it to be a key
source of data for ensuring management is implemented at the right scale in
future. For example, identifying hot-spots for bycatch reduction or identifying
spatial overlaps in mixed fisheries \citep{Dolder2018, Gardner2008, Little2014,
	Dedman2015, Ward2015}. Our simulation model has the potential to test
some of the assumptions behind the modelling approaches in identifying such
hotspots and indeed behind spatiotemporal modelling in general (e.g. comparing
GAMs, GLMMs, Random Forests and geostatistical models under different data
generation processes as exampled by \cite{Stock2019}). \\

Other novel applications of our framework could be: testing different survey
designs given multiple species and data generating assumptions \citep{Xu2015};
commercial index standardisation methods and approaches and understanding of
appropriate scales and data aggregations and non-proportionality in catch rate
and abundance \citep{Harley2001, Maunder2004}; exploring assumptions about the
distribution of natural mortality and fishing mortality throughout the year and
importance of capturing in-year dynamics in estimating stock status
\citep{Liu2013}; at sea sampling scheme designs to deliver unbiased estimates
of population parameters \citep{Cotter2007, Kimura2006}; adaptive management
\citep{Walters2007, Dunn2016}; testing the ability of commonly employed fleet
dynamics models such as Random Utility Models to capture fine scale dynamics
and understand their importance \citep{Girardin2016}; and as a detailed
operating model in a management strategy evaluation \citep{Mahevas2004}. \\

\section{Conclusions}

\textit{MixFishSim} provides a detailed simulation framework to explore the
interaction of multiple fisheries exploiting different fish populations. The
framework enables users to evaluate assumptions in modelling commercially
derived data through comparison to the true underlying dynamics at a fine
spatial and temporal scale.  Understanding these dynamics, the limitations of
the data and any potential biases that may be introduced when making inference
on spatiotemporal interactions will enable users to identify weaknesses in
modelling approaches and identity where data collection is needed to strengthen
inference. \\

Our application shows that inference on community dynamics may change depending
on the scale of data aggregation. There is an important balance in ensuring
that the data are sufficiently spatially and temporally disaggregated that the
main features of the data are captured, yet maintaining enough data coverage
that the features can be distinguished. We found in our application that there
was greater spatial heterogeneity than temporal heterogeneity and that when
using aggregated data to define spatial closures coarser temporal resolution
(months instead of weeks) could still achieve the same results in reducing
exploitation rates of a vulnerable species at the highest temporal resolution
data. Conversely, reducing the spatial resolution had a negative effect on the
effectiveness of the measures (though importantly, there was still some benefit
even with coarse spatial resolution). \\

While any findings are likely to be case specific, our findings emphasise the
need to understand population demographics, habitat use and movement rates in
designing any closure scenario based on observational sampling. This
information can then be used to set the bounds on data aggregation used in
modelling studies aimed at informing the management measures. \\ 

\textit{MixFishSim} has numerous potential additional applications as it
enables the user to apply methods to a fisheries system where there is detailed
understanding of underlying spatiotemporal dynamics. This enables
identification of weaknesses or limitations which would not be possible
otherwise. In future, we recommend use of the framework to test hypothesis that
are otherwise unable to be analysed using real world data due to limitations of
data collection. That way the knowledge gained through simulation can inform
the future design of management measures. 

\section*{Funding} This work was supported by the MARES doctoral training
program (MARES\_14\_15) and the Centre for Environment, Fisheries and
Aquaculture Science seedcorn program (DP227AC).

\section*{Appendices}

\input{parameter_tables.tex}

\clearpage
\footnotesize
\input{F_changes.tex}

\input{Temp_proportions.tex}


%%%%%%%%%%%%%%%%%
%%%% figures %%%%
%%%%%%%%%%%%%%%%%

%% the tikz figure
\clearpage
\input{Process_model.tex}
%\begin{comment}

\begin{figure}[!ht]
	\includegraphics[width = \linewidth]{Plots/pop_dist}
	\caption{Spatial density (log abundance) for each of the four
		populations at four time steps. The darker the colour the
		greater the density of the population. Note that you can see
		the diagonal isotropic patterns in populations 2 and 3 and
		concentrated spawning areas in the second row of the panels
		(t=18).}
	\label{fig:9}
\end{figure}	

\begin{figure}[!ht]
	\includegraphics[width = \linewidth]{Plots/f_dynamics}
	\caption{Fishing mortality dynamics - the daily fishing mortalities
		across the entire spatial domain showing weekly and seasonal
		patterns in exploitation.  Individual years and the light grey
		lines, the mean of all years the thick black line.}
	\label{fig:10}
\end{figure}	

\begin{figure}[!ht]
	\includegraphics[width = \linewidth]{Plots/Combined_Movement}
	\caption{(A) The fishing locations (points) and movements (lines) of a
		single vessel during a trip overlaid on the revenue of a
		fishing site (catch x price); (B) the fishing locations of the
		vessel over several trips (value field changes over the period
		so not shown). Note that the field is wrapped on a torus so
		that distances between opposite side of the spatial domain are
		considered next to each other, hence apparent large movements;
		(C) the locations of multiple vessels from the same fleet
		overlaid on the value field, (D) the realised step distance and
		turning angles for a single vessel over the simulation.}
	\label{fig:mv}
\end{figure}	


\begin{figure}[!ht]
	\includegraphics[width=\linewidth]{../analysis/Data_Aggregation_space_Rev2}
	\caption{Data aggregation at different spatial resolutions over a
		ten year period.}
	\label{fig:1}
\end{figure}	

\begin{figure}[!ht]
	\includegraphics[width=\linewidth]{../analysis/Data_Aggregation_time_Rev2}
	\caption{Proportion of each population (y axis) for data aggregated at
		different temporal resolutions. Data is aggregated over a
		ten-year period for an area 20 x 20. Each bar represents either
		a week, month or year respectively.}
	\label{fig:2}
\end{figure}	


\begin{figure}[!ht]
	\includegraphics[width = \linewidth]{../analysis/F_trendsREV}
	\caption{Comparison of closure scenarios effect on fishing mortality
		trends. Line colour denotes timescale, while linestyle
		denotes spatial resolution. The vertical dashed line
		indicates the onset of the spatial closures.}
	\label{fig:3}
\end{figure}

\begin{figure}[!ht]
	\includegraphics[width =\linewidth]{../analysis/f_diff_effectiveness}
	\caption{Comparison of closure scenario effectiveness based on
		different spatial and temporal resolutions.}
	\label{fig:4}
\end{figure}	

\begin{figure}[!ht]
	\centering
	\includegraphics[width =0.5\linewidth]{./Plots/Closure_fishing_locations_yearly}
	\caption{Closure fishing locations based on annual closures with a
		coarse spatial resolution. Closure location can be seen in red
		box in relation to a) before the closure fishing locations, b)
		after the closure fishing locations, c) population 3 habitat
		distribution.}
	\label{fig:17}
\end{figure}	
%\end{comment}

\clearpage

\section*{References}

\bibliography{simulation_framework}

\end{document}
